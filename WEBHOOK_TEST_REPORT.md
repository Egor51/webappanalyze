# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ Webhook –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞ —Ü–µ–Ω

## –î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: $(date)

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ Webhook —Ä–∞–±–æ—Ç–∞–µ—Ç
- **URL**: `https://my-traffic.space/webhook-test/forecast`
- **HTTP Status**: `200 OK`
- **–ú–µ—Ç–æ–¥**: `POST`
- **Content-Type**: `application/json`

### üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ

–ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:

```json
{
  "address": "–ú—É—Ä–º–∞–Ω—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 72",
  "historicalData": [
    {"date": "2024-01-01T00:00:00", "avgPrice": 5000000},
    {"date": "2024-02-01T00:00:00", "avgPrice": 5100000},
    ...
  ],
  "historicalDataString": "[{\"date\": \"2024-01-01T00:00:00\", \"avgPrice\": 5000000}, ...]"
}
```

**–ü–æ–ª—è:**
- `address` (String) - –ê–¥—Ä–µ—Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
- `historicalData` (Array) - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏ `date` –∏ `avgPrice`
- `historicalDataString` (String) - JSON —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ n8n –ø—Ä–æ–º–ø—Ç–∞—Ö

### üì• –ü–æ–ª—É—á–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç

**–¢–µ–∫—É—â–∏–π —Ñ–æ—Ä–º–∞—Ç (n8n):**
```json
[
  {
    "output": {
      "forecast": {
        "month3": 5650000,
        "month6": 5750000,
        "month12": 5900000
      },
      "reasoning": "–¶–µ–Ω—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π —Ä–æ—Å—Ç..."
    }
  }
]
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç (–ø—Ä—è–º–æ–π):**
```json
{
  "forecast": {
    "month3": 5650000,
    "month6": 5750000,
    "month12": 5900000
  },
  "reasoning": "–¶–µ–Ω—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π —Ä–æ—Å—Ç..."
}
```

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–≤–µ—Ç–∞

- ‚úÖ –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ `forecast`
- ‚úÖ –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç `month3` (–ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 3 –º–µ—Å—è—Ü–∞)
- ‚úÖ –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç `month6` (–ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 6 –º–µ—Å—è—Ü–µ–≤)
- ‚úÖ –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç `month12` (–ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 12 –º–µ—Å—è—Ü–µ–≤)
- ‚úÖ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —á–∏—Å–ª–æ–≤—ã–µ (–≤ —Ä—É–±–ª—è—Ö)

### üîß –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `getMLForecast`** (`src/utils/forecastML.js`):
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ n8n (–º–∞—Å—Å–∏–≤ —Å `output`)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä—è–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

2. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è** (`N8N_SETUP.md`):
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–æ—Ä–º–∞—Ç–∞—Ö –æ—Ç–≤–µ—Ç–∞
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Respond to Webhook
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤

### üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è n8n workflow:**
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Respond to Webhook –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä—è–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{{$json.forecast}}` –≤ Response Body –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª Set –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

2. **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
   - –ö–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–±–∞ —Ñ–æ—Ä–º–∞—Ç–∞
   - Webhook —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –æ—Ç–≤–µ—Ç–µ

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
curl -X POST https://my-traffic.space/webhook-test/forecast \
  -H "Content-Type: application/json" \
  -d '{
    "address": "–ú—É—Ä–º–∞–Ω—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 72",
    "historicalData": [
      {"date": "2024-01-01T00:00:00", "avgPrice": 5000000},
      {"date": "2024-02-01T00:00:00", "avgPrice": 5100000},
      {"date": "2024-03-01T00:00:00", "avgPrice": 5200000}
    ],
    "historicalDataString": "[{\"date\": \"2024-01-01T00:00:00\", \"avgPrice\": 5000000}, {\"date\": \"2024-02-01T00:00:00\", \"avgPrice\": 5100000}, {\"date\": \"2024-03-01T00:00:00\", \"avgPrice\": 5200000}]"
  }'
```

### ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

**Webhook —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!**

- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è
- ‚úÖ –ö–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

